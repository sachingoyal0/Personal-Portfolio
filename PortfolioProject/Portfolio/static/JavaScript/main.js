class ThemeManager{constructor(){this.themeToggle=null;this.currentTheme=this.getStoredTheme()||this.getSystemPreference();this.init();}init(){this.applyTheme(this.currentTheme);this.createThemeToggle();this.addEventListeners();this.watchSystemPreference();}getStoredTheme(){return localStorage.getItem('theme');}setStoredTheme(theme){localStorage.setItem('theme',theme);}getSystemPreference(){if(window.matchMedia&&window.matchMedia('(prefers-color-scheme:dark)').matches){return 'dark';}return 'light';}applyTheme(theme){document.documentElement.setAttribute('data-theme',theme);this.currentTheme=theme;this.setStoredTheme(theme);this.updateToggleIcon(theme);}toggleTheme(){const newTheme=this.currentTheme==='light'?'dark':'light';this.applyTheme(newTheme);document.dispatchEvent(new CustomEvent('themeChanged',{detail:{theme:newTheme}}));}createThemeToggle(){if(document.getElementById('theme-toggle')){this.themeToggle=document.getElementById('theme-toggle');return;}const toggle=document.createElement('button');toggle.id='theme-toggle';toggle.className='theme-toggle-btn';toggle.setAttribute('aria-label','Toggle theme');toggle.setAttribute('title','Toggle light/dark theme');const icon=document.createElement('span');icon.className='theme-icon';toggle.appendChild(icon);const header=document.querySelector('header')||document.querySelector('.header-container');if(header){header.appendChild(toggle);}else{document.body.appendChild(toggle);}this.themeToggle=toggle;this.updateToggleIcon(this.currentTheme);}updateToggleIcon(theme){if(!this.themeToggle)return;const icon=this.themeToggle.querySelector('.theme-icon');if(icon){if(theme==='dark'){icon.innerHTML='☀️';icon.setAttribute('aria-label','Switch to light theme');}else{icon.innerHTML='🌙';icon.setAttribute('aria-label','Switch to dark theme');}}}addEventListeners(){if(this.themeToggle){this.themeToggle.addEventListener('click',()=>this.toggleTheme());}document.addEventListener('keydown',(e)=>{if((e.altKey||e.metaKey)&&e.key.toLowerCase()==='t'){e.preventDefault();this.toggleTheme();}});}watchSystemPreference(){if(!window.matchMedia)return;const mediaQuery=window.matchMedia('(prefers-color-scheme:dark)');const handleChange=(e)=>{if(!this.getStoredTheme()){const newTheme=e.matches?'dark':'light';this.applyTheme(newTheme);}};if(mediaQuery.addEventListener){mediaQuery.addEventListener('change',handleChange);}else{mediaQuery.addListener(handleChange);}}getCurrentTheme(){return this.currentTheme;}setTheme(theme){if(['light','dark'].includes(theme)){this.applyTheme(theme);}}}document.addEventListener('DOMContentLoaded',()=>{window.themeManager=new ThemeManager();});if(typeof module!=='undefined'&&module.exports){module.exports=ThemeManager;}